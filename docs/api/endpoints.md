# API Endpoints

This document provides a comprehensive reference for all Sport Scribe API endpoints.

## Base URL

- **Production**: `https://api.sportscribe.com`
- **Staging**: `https://staging-api.sportscribe.com`
- **Development**: `http://localhost:8000`

## Common Headers

```http
Content-Type: application/json
Authorization: Bearer <jwt_token>
X-API-Key: <api_key>  // Alternative to Bearer token
```

## Response Format

All API responses follow a consistent format:

```json
{
  "success": boolean,
  "data": any,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human readable error message",
    "details": "Additional error details"
  },
  "message": "Success message",
  "timestamp": "2024-01-15T10:00:00Z",
  "request_id": "req_123456789"
}
```

## Authentication Endpoints

### Register User

```http
POST /auth/register
```

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "secure_password123",
  "name": "John Doe",
  "role": "reader"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "123e4567-e89b-12d3-a456-426614174000",
      "email": "user@example.com",
      "name": "John Doe",
      "role": "reader",
      "created_at": "2024-01-15T10:00:00Z"
    },
    "session": {
      "access_token": "eyJhbGciOiJIUzI1NiIs...",
      "refresh_token": "v1.Mr5hBVBTSSxn...",
      "expires_at": 1705395600,
      "token_type": "bearer"
    }
  }
}
```

### Login

```http
POST /auth/login
```

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "secure_password123"
}
```

### Refresh Token

```http
POST /auth/refresh
```

**Request Body:**
```json
{
  "refresh_token": "v1.Mr5hBVBTSSxn..."
}
```

### Logout

```http
POST /auth/logout
```

## Article Endpoints

### Get Articles

```http
GET /api/articles
```

**Query Parameters:**
- `page` (integer): Page number (default: 1)
- `limit` (integer): Items per page (default: 20, max: 100)
- `sport` (string): Filter by sport
- `league` (string): Filter by league
- `status` (string): Filter by status (draft, published, archived)
- `search` (string): Search in title and content
- `tags` (string): Comma-separated tags
- `sort` (string): Sort field (created_at, published_at, title)
- `order` (string): Sort order (asc, desc)

**Example Request:**
```bash
GET /api/articles?sport=basketball&league=NBA&limit=10&sort=published_at&order=desc
```

**Response:**
```json
{
  "success": true,
  "data": {
    "articles": [
      {
        "id": "123e4567-e89b-12d3-a456-426614174000",
        "title": "Lakers Beat Warriors in Overtime Thriller",
        "summary": "LeBron James scored 35 points as the Lakers defeated the Warriors 125-120 in overtime.",
        "author": "AI Sports Writer",
        "sport": "basketball",
        "league": "NBA",
        "status": "published",
        "published_at": "2024-01-15T20:00:00Z",
        "created_at": "2024-01-15T19:30:00Z",
        "updated_at": "2024-01-15T19:45:00Z",
        "tags": ["NBA", "Lakers", "Warriors", "LeBron James"],
        "featured_image_url": "https://images.sportscribe.com/articles/123.jpg",
        "reading_time_minutes": 5,
        "seo_keywords": ["Lakers", "Warriors", "NBA", "overtime"]
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 150,
      "total_pages": 15,
      "has_next": true,
      "has_previous": false
    }
  }
}
```

### Get Article by ID

```http
GET /api/articles/{article_id}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": "123e4567-e89b-12d3-a456-426614174000",
    "title": "Lakers Beat Warriors in Overtime Thriller",
    "content": "Full article content here...",
    "summary": "LeBron James scored 35 points...",
    "author": "AI Sports Writer",
    "sport": "basketball",
    "league": "NBA",
    "game_id": "456e7890-f12b-34c5-d678-901234567890",
    "status": "published",
    "published_at": "2024-01-15T20:00:00Z",
    "created_at": "2024-01-15T19:30:00Z",
    "updated_at": "2024-01-15T19:45:00Z",
    "tags": ["NBA", "Lakers", "Warriors"],
    "featured_image_url": "https://images.sportscribe.com/articles/123.jpg",
    "reading_time_minutes": 5,
    "seo_keywords": ["Lakers", "Warriors", "NBA"],
    "byline": "Generated by Sport Scribe AI"
  }
}
```

### Create Article

```http
POST /api/articles
```

**Request Body:**
```json
{
  "title": "New Article Title",
  "content": "Full article content...",
  "summary": "Article summary",
  "sport": "basketball",
  "league": "NBA",
  "game_id": "456e7890-f12b-34c5-d678-901234567890",
  "tags": ["NBA", "Basketball"],
  "featured_image_url": "https://example.com/image.jpg",
  "seo_keywords": ["NBA", "Basketball"],
  "status": "draft"
}
```

### Update Article

```http
PUT /api/articles/{article_id}
```

**Request Body:** Same as create article

### Delete Article

```http
DELETE /api/articles/{article_id}
```

### Generate Article

```http
POST /api/articles/generate
```

**Request Body:**
```json
{
  "game_id": "456e7890-f12b-34c5-d678-901234567890",
  "focus_type": "game_recap",
  "target_length": 800,
  "include_stats": true,
  "include_quotes": true,
  "tone": "professional"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": "gen_123e4567-e89b-12d3-a456-426614174000",
    "status": "pending",
    "game_id": "456e7890-f12b-34c5-d678-901234567890",
    "estimated_completion": "2024-01-15T20:05:00Z"
  }
}
```

### Get Generation Status

```http
GET /api/articles/generate/{generation_id}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": "gen_123e4567-e89b-12d3-a456-426614174000",
    "status": "completed",
    "article_id": "123e4567-e89b-12d3-a456-426614174000",
    "created_at": "2024-01-15T20:00:00Z",
    "completed_at": "2024-01-15T20:03:00Z"
  }
}
```

## Game Endpoints

### Get Games

```http
GET /api/games
```

**Query Parameters:**
- `page` (integer): Page number
- `limit` (integer): Items per page
- `sport` (string): Filter by sport
- `league` (string): Filter by league
- `status` (string): Filter by game status
- `date_from` (string): Start date (ISO format)
- `date_to` (string): End date (ISO format)
- `team_id` (string): Filter by team

**Response:**
```json
{
  "success": true,
  "data": {
    "games": [
      {
        "id": "456e7890-f12b-34c5-d678-901234567890",
        "home_team": {
          "id": "team_123",
          "name": "Los Angeles Lakers",
          "abbreviation": "LAL"
        },
        "away_team": {
          "id": "team_456",
          "name": "Golden State Warriors",
          "abbreviation": "GSW"
        },
        "home_score": 125,
        "away_score": 120,
        "game_date": "2024-01-15T20:00:00Z",
        "status": "final",
        "period": 5,
        "time_remaining": "00:00",
        "venue": {
          "id": "venue_789",
          "name": "Crypto.com Arena",
          "city": "Los Angeles",
          "state": "CA"
        },
        "sport": "basketball",
        "league": "NBA"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "total_pages": 3
    }
  }
}
```

### Get Game by ID

```http
GET /api/games/{game_id}
```

### Get Game Statistics

```http
GET /api/games/{game_id}/stats
```

**Response:**
```json
{
  "success": true,
  "data": {
    "team_stats": {
      "home": {
        "points": 125,
        "field_goals_made": 45,
        "field_goals_attempted": 92,
        "three_pointers_made": 15,
        "free_throws_made": 20,
        "rebounds": 48,
        "assists": 28,
        "steals": 8,
        "blocks": 5,
        "turnovers": 12
      },
      "away": {
        "points": 120,
        "field_goals_made": 42,
        "field_goals_attempted": 88,
        "three_pointers_made": 18,
        "free_throws_made": 18,
        "rebounds": 45,
        "assists": 25,
        "steals": 6,
        "blocks": 7,
        "turnovers": 15
      }
    },
    "player_stats": [
      {
        "player_id": "player_123",
        "player_name": "LeBron James",
        "team_id": "team_123",
        "points": 35,
        "rebounds": 12,
        "assists": 8,
        "minutes": 42
      }
    ]
  }
}
```

## Team Endpoints

### Get Teams

```http
GET /api/teams
```

**Query Parameters:**
- `sport` (string): Filter by sport
- `league` (string): Filter by league
- `conference` (string): Filter by conference
- `division` (string): Filter by division

### Get Team by ID

```http
GET /api/teams/{team_id}
```

### Get Team Players

```http
GET /api/teams/{team_id}/players
```

### Get Team Schedule

```http
GET /api/teams/{team_id}/schedule
```

**Query Parameters:**
- `season` (string): Season year
- `date_from` (string): Start date
- `date_to` (string): End date

## Player Endpoints

### Get Players

```http
GET /api/players
```

**Query Parameters:**
- `sport` (string): Filter by sport
- `team_id` (string): Filter by team
- `position` (string): Filter by position
- `search` (string): Search by name

### Get Player by ID

```http
GET /api/players/{player_id}
```

### Get Player Statistics

```http
GET /api/players/{player_id}/stats
```

**Query Parameters:**
- `season` (string): Season year
- `game_type` (string): regular_season, playoffs, preseason

## Analytics Endpoints

### Get Article Analytics

```http
GET /api/analytics/articles
```

**Query Parameters:**
- `date_from` (string): Start date
- `date_to` (string): End date
- `article_id` (string): Specific article
- `sport` (string): Filter by sport
- `metric` (string): views, shares, comments, reading_time

**Response:**
```json
{
  "success": true,
  "data": {
    "metrics": {
      "total_views": 15420,
      "unique_views": 12350,
      "average_reading_time": 4.2,
      "bounce_rate": 0.35,
      "engagement_rate": 0.68
    },
    "daily_stats": [
      {
        "date": "2024-01-15",
        "views": 1250,
        "unique_views": 980,
        "shares": 45,
        "comments": 12
      }
    ]
  }
}
```

### Get System Analytics

```http
GET /api/analytics/system
```

**Response:**
```json
{
  "success": true,
  "data": {
    "articles": {
      "total": 1500,
      "published": 1200,
      "draft": 250,
      "archived": 50
    },
    "generation_stats": {
      "total_requests": 2500,
      "successful": 2350,
      "failed": 150,
      "average_time": 3.2
    },
    "user_activity": {
      "active_users": 450,
      "new_registrations": 25,
      "api_requests": 15000
    }
  }
}
```

## User Management Endpoints

### Get User Profile

```http
GET /api/user/profile
```

### Update User Profile

```http
PUT /api/user/profile
```

**Request Body:**
```json
{
  "name": "Updated Name",
  "bio": "User bio",
  "preferences": {
    "theme": "dark",
    "notifications": {
      "email": true,
      "push": false
    }
  }
}
```

### Get User API Keys

```http
GET /api/user/api-keys
```

### Create API Key

```http
POST /api/user/api-keys
```

**Request Body:**
```json
{
  "name": "My API Key",
  "description": "For automated article generation",
  "permissions": ["articles:read", "articles:generate"],
  "expires_at": "2024-12-31T23:59:59Z"
}
```

### Delete API Key

```http
DELETE /api/user/api-keys/{key_id}
```

## Admin Endpoints

### Get All Users

```http
GET /api/admin/users
```

**Requires:** `users:read` permission

### Update User Role

```http
PUT /api/admin/users/{user_id}/role
```

**Request Body:**
```json
{
  "role": "editor"
}
```

**Requires:** `users:manage_roles` permission

### Get System Configuration

```http
GET /api/admin/config
```

### Update System Configuration

```http
PUT /api/admin/config
```

**Request Body:**
```json
{
  "key": "max_article_length",
  "value": 2000,
  "description": "Maximum article length in words"
}
```

## Error Responses

### 400 Bad Request

```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid request data",
    "details": {
      "field_errors": {
        "email": ["Email is required"],
        "password": ["Password must be at least 8 characters"]
      }
    }
  }
}
```

### 401 Unauthorized

```json
{
  "success": false,
  "error": {
    "code": "UNAUTHORIZED",
    "message": "Authentication required",
    "details": "Valid authentication token required"
  }
}
```

### 403 Forbidden

```json
{
  "success": false,
  "error": {
    "code": "FORBIDDEN",
    "message": "Insufficient permissions",
    "details": "You don't have permission to access this resource"
  }
}
```

### 404 Not Found

```json
{
  "success": false,
  "error": {
    "code": "NOT_FOUND",
    "message": "Resource not found",
    "details": "The requested article could not be found"
  }
}
```

### 429 Rate Limit Exceeded

```json
{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests",
    "details": "Rate limit exceeded. Try again in 60 seconds",
    "retry_after": 60
  }
}
```

### 500 Internal Server Error

```json
{
  "success": false,
  "error": {
    "code": "INTERNAL_ERROR",
    "message": "Internal server error",
    "details": "An unexpected error occurred"
  }
}
```

## Rate Limits

| Endpoint Category | Authenticated | Unauthenticated |
|------------------|---------------|-----------------|
| Authentication   | 10/min        | 5/min          |
| Articles (Read)  | 1000/hour     | 100/hour       |
| Articles (Write) | 100/hour      | N/A            |
| Generation       | 50/hour       | N/A            |
| Analytics        | 500/hour      | N/A            |
| Admin            | 200/hour      | N/A            |

## Pagination

All list endpoints support pagination with the following parameters:

- `page`: Page number (starting from 1)
- `limit`: Items per page (default: 20, max: 100)

Response includes pagination metadata:

```json
{
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 150,
    "total_pages": 8,
    "has_next": true,
    "has_previous": false
  }
}
```

## Filtering and Sorting

### Common Filter Parameters

- `sport`: basketball, football, baseball, hockey, soccer
- `league`: NBA, NFL, MLB, NHL, MLS, etc.
- `status`: For articles (draft, published, archived), games (scheduled, live, final)
- `date_from` / `date_to`: ISO 8601 date strings
- `search`: Text search in relevant fields

### Sorting

- `sort`: Field to sort by
- `order`: `asc` or `desc`

Example:
```
GET /api/articles?sort=published_at&order=desc&sport=basketball
```

## SDK Examples

### JavaScript/TypeScript

```typescript
import { SportScribeAPI } from '@sportscribe/api-client';

const client = new SportScribeAPI({
  apiKey: 'your-api-key',
  baseURL: 'https://api.sportscribe.com'
});

// Get articles
const articles = await client.articles.list({
  sport: 'basketball',
  league: 'NBA',
  limit: 10
});

// Generate article
const generation = await client.articles.generate({
  gameId: 'game-id',
  focusType: 'game_recap',
  targetLength: 800
});
```

### Python

```python
from sportscribe import SportScribeClient

client = SportScribeClient(
    api_key='your-api-key',
    base_url='https://api.sportscribe.com'
)

# Get articles
articles = client.articles.list(
    sport='basketball',
    league='NBA',
    limit=10
)

# Generate article
generation = client.articles.generate(
    game_id='game-id',
    focus_type='game_recap',
    target_length=800
)
```

## Related Documentation

- [Authentication](./authentication.md)
- [Webhooks](./webhooks.md)
- [Rate Limiting](../development/rate-limiting.md)
- [SDKs and Libraries](../development/sdks.md) 